<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Leaderboard</title>
    <link rel="stylesheet" href="Dungeon.css">
    <link rel="stylesheet" href="lead.css">
</head>
<body>
    <div class="leaderboard-container">
        <h1>Game Leaderboard</h1>
        
        <div class="input-section">
            <input type="text" id="playerName" placeholder="Section and Class Number">
            <input type="number" id="playerScore" placeholder="Time in Seconds">
            <button onclick="addScore()">Add Score</button>
        </div>

        <table id="leaderboardTable">
            <thead>
                <tr>
                    <th>Placement</th>
                    <th>Sec. & CN</th>
                    <th>Time</th>
                    <th>Delete?</th>
                </tr>
            </thead>
            <tbody id="leaderboardBody">
            </tbody>
        </table>

        <div class="pagination">
            <button id="prevBtn" onclick="changePage(-1)" disabled>Previous</button>
            <button id="nextBtn" onclick="changePage(1)">Next</button>
            <button onclick="Returnhome()">Return Back to Home Screen</button>
        </div>
    </div>

    <div id="timer" style="font-size:2em; font-family:monospace;">00:00.000</div>
    <button onclick="stopThingy()">Stop Speedrun</button>

    <script>
        const STORAGE_KEY = 'gameLeaderboard';
        const ENTRIES_PER_PAGE = 5;
        let currentPage = 1;

        function loadLeaderboard() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
        }

        function saveLeaderboard(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        function addScore() {
            const name = document.getElementById('playerName').value.trim();
            const score = parseInt(document.getElementById('playerScore').value);

            if (!name || isNaN(score)) {
                alert('Please enter both name and score');
                return;
            }

            let leaderboard = loadLeaderboard();
            leaderboard.push({ name, score });
            leaderboard.sort((a, b) => a.score - b.score);
            saveLeaderboard(leaderboard);

            document.getElementById('playerName').value = '';
            document.getElementById('playerScore').value = '';
            displayLeaderboard();
        }

        function deleteScore(index) {
            let leaderboard = loadLeaderboard();
            leaderboard.splice(index, 1);
            saveLeaderboard(leaderboard);
            displayLeaderboard();
        }

        function displayLeaderboard() {
            const leaderboard = loadLeaderboard();
            const tbody = document.getElementById('leaderboardBody');
            tbody.innerHTML = '';

            const start = (currentPage - 1) * ENTRIES_PER_PAGE;
            const end = start + ENTRIES_PER_PAGE;
            const paginatedEntries = leaderboard.slice(start, end);

            paginatedEntries.forEach((entry, index) => {
                const row = `
                    <tr>
                        <td>${start + index + 1}</td>
                        <td>${entry.name}</td>
                        <td>${entry.score}</td>
                        <td><button onclick="deleteScore(${start + index})">Delete</button></td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });

            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = end >= leaderboard.length;
        }

        function changePage(direction) {
            currentPage += direction;
            displayLeaderboard();
        }

        displayLeaderboard();

        function Returnhome()
        {
            window.location.href = "../Start/mainPROJECT.html"
        }
    </script>
    <script src="time.js">
    </script>
</body>
</html>